SELECT department_id, first_name, last_name, salary,
       RANK()       OVER (PARTITION BY department_id ORDER BY salary DESC) AS rnk,
       DENSE_RANK() OVER (PARTITION BY department_id ORDER BY salary DESC) AS drnk
FROM hr.employees
WHERE salary BETWEEN 8000 AND 15000
ORDER BY department_id, salary DESC;
